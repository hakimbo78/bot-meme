# OFF-CHAIN SCREENER - ARCHITECTURE OVERVIEW

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        OFF-CHAIN DATA SOURCES                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   DexScreener    â”‚              â”‚    DEXTools      â”‚            â”‚
â”‚  â”‚   (Mandatory)    â”‚              â”‚   (Optional)     â”‚            â”‚
â”‚  â”‚                  â”‚              â”‚                  â”‚            â”‚
â”‚  â”‚  â€¢ Free API      â”‚              â”‚  â€¢ Requires Key  â”‚            â”‚
â”‚  â”‚  â€¢ 30-60s scans  â”‚              â”‚  â€¢ 90-180s scans â”‚            â”‚
â”‚  â”‚  â€¢ New pairs     â”‚              â”‚  â€¢ Top gainers   â”‚            â”‚
â”‚  â”‚  â€¢ Trending      â”‚              â”‚  â€¢ Rank based    â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚           â”‚                                 â”‚                       â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                         â”‚                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     OFF-CHAIN SCREENER MODULE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  1. SCHEDULER (scheduler.py)                               â”‚    â”‚
â”‚  â”‚     â€¢ DexScreener: 30-60s jittered intervals               â”‚    â”‚
â”‚  â”‚     â€¢ DEXTools: 90-180s jittered intervals                 â”‚    â”‚
â”‚  â”‚     â€¢ Adaptive scaling based on market activity            â”‚    â”‚
â”‚  â”‚     â€¢ Emergency backoff on rate limits                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  2. API CLIENTS                                            â”‚    â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚    â”‚
â”‚  â”‚     â”‚ dex_screener.py  â”‚   â”‚ dextools_screenerâ”‚           â”‚    â”‚
â”‚  â”‚     â”‚ - Rate limiting  â”‚   â”‚ - Rate limiting  â”‚           â”‚    â”‚
â”‚  â”‚     â”‚ - Error handling â”‚   â”‚ - Error handling â”‚           â”‚    â”‚
â”‚  â”‚     â”‚ - Auto retry     â”‚   â”‚ - Auto retry     â”‚           â”‚    â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  3. NORMALIZER (normalizer.py)                             â”‚    â”‚
â”‚  â”‚     â€¢ Convert DexScreener format â†’ Normalized Event        â”‚    â”‚
â”‚  â”‚     â€¢ Convert DEXTools format â†’ Normalized Event           â”‚    â”‚
â”‚  â”‚     â€¢ Calculate confidence score (0.0-1.0)                 â”‚    â”‚
â”‚  â”‚     â€¢ Determine event type (NEW_PAIR, PRICE_SPIKE, etc)    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  4. DEDUPLICATOR (deduplicator.py)                         â”‚    â”‚
â”‚  â”‚     â€¢ Track seen pairs (per chain)                         â”‚    â”‚
â”‚  â”‚     â€¢ 10-minute cooldown period                            â”‚    â”‚
â”‚  â”‚     â€¢ Thread-safe operations                               â”‚    â”‚
â”‚  â”‚     â€¢ Prevents redundant processing                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  5. FILTERS (filters.py)                                   â”‚    â”‚
â”‚  â”‚                                                            â”‚    â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚     â”‚  LEVEL-0 FILTER (Basic Criteria)           â”‚       â”‚    â”‚
â”‚  â”‚     â”‚  âœ“ Liquidity >= $5,000                     â”‚       â”‚    â”‚
â”‚  â”‚     â”‚  âœ“ Volume (5m) >= $1,000                   â”‚       â”‚    â”‚
â”‚  â”‚     â”‚  âœ“ Transactions (5m) >= 5                  â”‚       â”‚    â”‚
â”‚  â”‚     â”‚  âœ“ Age < 24 hours                          â”‚       â”‚    â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                       â–¼                                    â”‚    â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚     â”‚  LEVEL-1 FILTER (Momentum Criteria)        â”‚       â”‚    â”‚
â”‚  â”‚     â”‚  Must have at least ONE:                   â”‚       â”‚    â”‚
â”‚  â”‚     â”‚  âœ“ Price change >= 20% (5m) OR >= 50% (1h)â”‚       â”‚    â”‚
â”‚  â”‚     â”‚  âœ“ Volume spike ratio >= 2.0x              â”‚       â”‚    â”‚
â”‚  â”‚     â”‚  âœ“ TX acceleration >= 1.5x                 â”‚       â”‚    â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                       â–¼                                    â”‚    â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚     â”‚  DEXTOOLS GUARANTEE RULE                   â”‚       â”‚    â”‚
â”‚  â”‚     â”‚  IF source == "dextools" AND rank <= 50:   â”‚       â”‚    â”‚
â”‚  â”‚     â”‚    â†’ BYPASS ALL FILTERS                    â”‚       â”‚    â”‚
â”‚  â”‚     â”‚    â†’ FORCE SCORE BOOST                     â”‚       â”‚    â”‚
â”‚  â”‚     â”‚    â†’ IMMEDIATE ON-CHAIN VERIFY             â”‚       â”‚    â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                                                            â”‚    â”‚
â”‚  â”‚     Result: ~95% filtered out, ~5% pass to scoring        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  6. OFF-CHAIN SCORING                                      â”‚    â”‚
â”‚  â”‚     â€¢ Price momentum: 0-40 points                          â”‚    â”‚
â”‚  â”‚     â€¢ Volume metrics: 0-30 points                          â”‚    â”‚
â”‚  â”‚     â€¢ Transaction activity: 0-20 points                    â”‚    â”‚
â”‚  â”‚     â€¢ Liquidity: 0-10 points                               â”‚    â”‚
â”‚  â”‚     â€¢ Source confidence: 0-10 points                       â”‚    â”‚
â”‚  â”‚     â€¢ DEXTools rank boost: 0-20 points                     â”‚    â”‚
â”‚  â”‚     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                    â”‚    â”‚
â”‚  â”‚     OFFCHAIN_SCORE: 0-100                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  7. CACHE (cache.py)                                       â”‚    â”‚
â”‚  â”‚     â€¢ TTL-based (5 minutes)                                â”‚    â”‚
â”‚  â”‚     â€¢ LRU eviction                                         â”‚    â”‚
â”‚  â”‚     â€¢ Thread-safe                                          â”‚    â”‚
â”‚  â”‚     â€¢ Saves redundant API calls                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  8. OUTPUT QUEUE                                           â”‚    â”‚
â”‚  â”‚     Normalized Pair Event {                                â”‚    â”‚
â”‚  â”‚       chain, dex, pair_address, token0, token1,            â”‚    â”‚
â”‚  â”‚       price_change_5m, price_change_1h,                    â”‚    â”‚
â”‚  â”‚       volume_5m, liquidity, tx_5m,                         â”‚    â”‚
â”‚  â”‚       source, confidence, event_type,                      â”‚    â”‚
â”‚  â”‚       offchain_score                                       â”‚    â”‚
â”‚  â”‚     }                                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXISTING PIPELINE (UNCHANGED)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  9. MAIN QUEUE (main.py)                                   â”‚    â”‚
â”‚  â”‚     â€¢ Receives normalized pairs from off-chain screener    â”‚    â”‚
â”‚  â”‚     â€¢ Also receives pairs from on-chain scanners           â”‚    â”‚
â”‚  â”‚     â€¢ Unified consumer task processes both                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  10. CONSUMER TASK                                         â”‚    â”‚
â”‚  â”‚      IF source_type == 'offchain':                         â”‚    â”‚
â”‚  â”‚        IF offchain_score >= verify_threshold (60):         â”‚    â”‚
â”‚  â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
â”‚  â”‚          â”‚  TRIGGER ON-CHAIN VERIFICATION       â”‚          â”‚    â”‚
â”‚  â”‚          â”‚  (STRICT RULES - ONLY ALLOWED CALLS) â”‚          â”‚    â”‚
â”‚  â”‚          â”‚                                      â”‚          â”‚    â”‚
â”‚  â”‚          â”‚  âœ“ eth_call                         â”‚          â”‚    â”‚
â”‚  â”‚          â”‚  âœ“ getReserves                      â”‚          â”‚    â”‚
â”‚  â”‚          â”‚  âœ“ balanceOf                        â”‚          â”‚    â”‚
â”‚  â”‚          â”‚  âœ“ totalSupply                      â”‚          â”‚    â”‚
â”‚  â”‚          â”‚  âœ— Block scanning                   â”‚          â”‚    â”‚
â”‚  â”‚          â”‚  âœ— eth_getLogs loops                â”‚          â”‚    â”‚
â”‚  â”‚          â”‚  âœ— Historical replay                â”‚          â”‚    â”‚
â”‚  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
â”‚  â”‚                       â–¼                                     â”‚    â”‚
â”‚  â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
â”‚  â”‚          â”‚  ON-CHAIN DATA RETRIEVED             â”‚          â”‚    â”‚
â”‚  â”‚          â”‚  â€¢ Reserves                          â”‚          â”‚    â”‚
â”‚  â”‚          â”‚  â€¢ Token balance                     â”‚          â”‚    â”‚
â”‚  â”‚          â”‚  â€¢ Total supply                      â”‚          â”‚    â”‚
â”‚  â”‚          â”‚  â€¢ Contract safety checks            â”‚          â”‚    â”‚
â”‚  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
â”‚  â”‚        ELSE:                                                â”‚    â”‚
â”‚  â”‚          Skip on-chain (save RPC calls)                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  11. EXISTING SCORE ENGINE (scorer.py)                     â”‚    â”‚
â”‚  â”‚      â€¢ Receives merged data (off-chain + on-chain)         â”‚    â”‚
â”‚  â”‚      â€¢ Calculates on-chain score                           â”‚    â”‚
â”‚  â”‚      â€¢ Applies existing scoring logic                      â”‚    â”‚
â”‚  â”‚                                                            â”‚    â”‚
â”‚  â”‚      ONCHAIN_SCORE = score_token(merged_data)              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  12. FINAL SCORE CALCULATION                               â”‚    â”‚
â”‚  â”‚                                                            â”‚    â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚      â”‚  FINAL_SCORE =                              â”‚     â”‚    â”‚
â”‚  â”‚      â”‚    (OFFCHAIN_SCORE Ã— 0.6) +                 â”‚     â”‚    â”‚
â”‚  â”‚      â”‚    (ONCHAIN_SCORE Ã— 0.4)                    â”‚     â”‚    â”‚
â”‚  â”‚      â”‚                                             â”‚     â”‚    â”‚
â”‚  â”‚      â”‚  Configurable weights:                      â”‚     â”‚    â”‚
â”‚  â”‚      â”‚  â€¢ offchain_weight: 0.6 (60%)               â”‚     â”‚    â”‚
â”‚  â”‚      â”‚  â€¢ onchain_weight: 0.4 (40%)                â”‚     â”‚    â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚                                                            â”‚    â”‚
â”‚  â”‚      Score breakdown:                                      â”‚    â”‚
â”‚  â”‚      â€¢ offchain_score: 0-100                               â”‚    â”‚
â”‚  â”‚      â€¢ onchain_score: 0-100                                â”‚    â”‚
â”‚  â”‚      â€¢ final_score: 0-100                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  13. ALERT DECISION                                        â”‚    â”‚
â”‚  â”‚      IF final_score >= TRADE_THRESHOLD (75):               â”‚    â”‚
â”‚  â”‚        â†’ Send TRADE alert                                  â”‚    â”‚
â”‚  â”‚      ELIF final_score >= WATCH_THRESHOLD (60):             â”‚    â”‚
â”‚  â”‚        â†’ Send WATCH alert                                  â”‚    â”‚
â”‚  â”‚      ELIF final_score >= INFO_THRESHOLD (40):              â”‚    â”‚
â”‚  â”‚        â†’ Send INFO alert                                   â”‚    â”‚
â”‚  â”‚      ELSE:                                                 â”‚    â”‚
â”‚  â”‚        â†’ Ignore                                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  14. TELEGRAM NOTIFICATION (telegram_notifier.py)          â”‚    â”‚
â”‚  â”‚      â€¢ Send formatted alert to Telegram                    â”‚    â”‚
â”‚  â”‚      â€¢ Include score breakdown                             â”‚    â”‚
â”‚  â”‚      â€¢ Show off-chain vs on-chain contribution             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## ğŸ“ˆ RPC Usage Comparison

### WITHOUT Off-Chain Screener

```
Hour 1:
â”œâ”€ 1000 pairs detected via on-chain scanning
â”œâ”€ 1000 Ã— 5 RPC calls = 5,000 RPC calls
â”œâ”€ Score engine processes all 1000
â””â”€ Result: ~50 quality alerts

Daily Total: 5,000 Ã— 24 = 120,000 RPC calls
Monthly Cost: $120
```

### WITH Off-Chain Screener

```
Hour 1:
â”œâ”€ 1000 pairs detected via DexScreener API (0 RPC)
â”œâ”€ 950 filtered by Level-0 + Level-1 (0 RPC)
â”œâ”€ 50 pass filters
â”œâ”€ Off-chain scoring: 50 pairs (0 RPC)
â”œâ”€ 40 fail verify_threshold (0 RPC)
â”œâ”€ 10 trigger on-chain verification
â”œâ”€ 10 Ã— 5 RPC calls = 50 RPC calls
â”œâ”€ Score engine processes 10 (combined scoring)
â””â”€ Result: ~8 quality alerts

Daily Total: 50 Ã— 24 = 1,200 RPC calls
Monthly Cost: $1.20

Savings: $118.80/month (99% reduction)
```

**Note**: Estimate is conservative. Actual may be higher (2,500-6,000 calls/day) if verify threshold is set lower, still achieving 95%+ savings.

---

## ğŸ”„ Data Flow Example

### Example: New Pair Detected

```
1. DexScreener API returns:
   {
     "pairAddress": "0xABC...",
     "baseToken": {"symbol": "PEPE2"},
     "priceChange": {"m5": 85.5, "h1": 250.0},
     "liquidity": {"usd": 45000},
     "volume": {"m5": 15000},
     "txns": {"m5": {"buys": 25, "sells": 18}}
   }

2. Normalizer converts to:
   {
     "chain": "base",
     "pair_address": "0xABC...",
     "price_change_5m": 85.5,
     "price_change_1h": 250.0,
     "liquidity": 45000,
     "volume_5m": 15000,
     "tx_5m": 43,
     "source": "dexscreener",
     "event_type": "PRICE_SPIKE"
   }

3. Deduplicator checks: NOT seen recently âœ“

4. Level-0 Filter:
   âœ“ Liquidity 45000 >= 5000
   âœ“ Volume 15000 >= 1000
   âœ“ TX 43 >= 5
   â†’ PASS

5. Level-1 Filter:
   âœ“ Price change 85.5% >= 20%
   â†’ PASS

6. Off-chain score calculated:
   + 15 (price 5m: 50-100%)
   + 15 (price 1h: 150-300%)
   + 10 (volume 5m: 10k-50k)
   + 7 (liquidity: 20k-50k)
   + 10 (tx: 20-50)
   + 5 (confidence: 0.5)
   = 62 points

7. Check threshold:
   62 >= 60 (verify_threshold)
   â†’ TRIGGER ON-CHAIN VERIFICATION

8. On-chain verify (5 RPC calls):
   - getReserves()
   - balanceOf(token0)
   - balanceOf(token1)
   - totalSupply()
   - owner()

9. On-chain score: 68

10. Final score:
    (62 Ã— 0.6) + (68 Ã— 0.4) = 64.4

11. Alert decision:
    64.4 >= 60 (WATCH threshold)
    â†’ SEND WATCH ALERT

12. Telegram notification sent âœ“
```

**Total RPC calls**: 5 (vs 5 without screener, but 95% of pairs never reach this step)

---

## ğŸ¯ Key Principles

### 1. **Fail Fast**
Filter out noise as early as possible (Level-0 â†’ Level-1 â†’ Dedup)

### 2. **Zero RPC While Idle**
All detection happens via free APIs until verification needed

### 3. **Confidence-Based Verification**
Only high-confidence signals (score >= threshold) trigger expensive on-chain calls

### 4. **Intelligent Caching**
Prevent redundant API calls and duplicate processing

### 5. **Adaptive Behavior**
- Scan frequency adjusts to market activity
- Emergency backoff on rate limits
- DEXTools top ranks bypass filters

### 6. **Graceful Degradation**
- Works without DEXTools (DexScreener only)
- Handles API failures gracefully
- Can be fully disabled via config

---

## ğŸ”§ Integration Points

The off-chain screener integrates with existing code at these points:

1. **Import** - 5 lines in main.py
2. **Initialize** - 15 lines in main.py
3. **Start tasks** - 3 lines in main.py
4. **Producer task** - 20 lines (new async function)
5. **Consumer handler** - 30 lines in existing consumer
6. **Cleanup** - 2 lines in finally block

**Total**: ~75 lines of integration code
**Breaking changes**: ZERO

---

## ğŸ“Š Monitoring Dashboard (Conceptual)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OFF-CHAIN SCREENER STATUS                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ Pipeline:                                               â”‚
â”‚   Total raw pairs:      1,247                           â”‚
â”‚   Normalized:           1,247                           â”‚
â”‚   Filtered out:         1,185 (95.0%)                   â”‚
â”‚   Deduplicated:            15 (1.2%)                    â”‚
â”‚   Passed to queue:         47 (3.8%)                    â”‚
â”‚                                                         â”‚
â”‚ Filters:                                                â”‚
â”‚   Level-0 filtered:      982                            â”‚
â”‚   Level-1 filtered:      203                            â”‚
â”‚   DEXTools forced:         3                            â”‚
â”‚                                                         â”‚
â”‚ RPC Savings:                                            â”‚
â”‚   Without screener:   30,000 calls/day                  â”‚
â”‚   With screener:       1,200 calls/day                  â”‚
â”‚   Savings:            28,800 calls/day (96%)            â”‚
â”‚                                                         â”‚
â”‚ Sources:                                                â”‚
â”‚   DexScreener:  42 scans, 1,189 pairs                   â”‚
â”‚   DEXTools:     14 scans,    58 pairs                   â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Created**: 2025-12-29  
**Status**: Production Ready  
**Architecture**: Event-Driven, Async, Fully Decoupled
